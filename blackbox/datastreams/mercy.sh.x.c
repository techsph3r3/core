#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -v -f mercy.sh 
#endif

static  char data [] = 
#define      tst1_z	22
#define      tst1	((&data[4]))
	"\131\030\012\051\160\345\111\163\205\057\270\241\132\367\075\177"
	"\175\203\367\174\200\075\143\151\236\357\021\011\025\142"
#define      pswd_z	256
#define      pswd	((&data[73]))
	"\225\145\071\002\341\235\164\350\231\056\327\047\324\155\371\201"
	"\247\200\101\154\331\131\166\003\153\200\031\316\215\303\237\042"
	"\050\330\045\012\165\232\362\016\311\311\065\272\131\011\247\105"
	"\271\112\062\203\055\120\121\373\211\345\061\100\172\066\277\270"
	"\075\226\375\142\233\023\022\327\346\217\222\100\230\072\206\122"
	"\204\270\326\262\011\050\255\222\016\336\323\210\024\222\100\121"
	"\051\076\264\305\122\306\235\071\126\057\171\356\152\377\101\356"
	"\270\030\240\302\100\115\125\117\054\050\327\100\273\030\222\345"
	"\127\106\252\251\014\107\342\143\167\134\122\341\134\223\320\024"
	"\254\160\327\354\276\054\073\352\124\023\052\020\054\274\365\203"
	"\003\240\054\020\347\017\163\137\153\305\100\307\131\020\334\005"
	"\201\263\362\077\337\056\052\064\101\125\105\155\022\072\360\025"
	"\332\035\045\302\054\231\042\227\136\142\137\270\163\073\275\365"
	"\356\257\064\316\335\137\003\037\264\110\214\306\202\175\334\135"
	"\233\002\040\307\233\102\137\372\245\276\262\031\372\157\016\351"
	"\037\103\270\374\242\273\033\126\003\250\035\206\046\371\344\301"
	"\374\004\211\227\107\350\222\354\247\104\006\242\264\024\214\323"
	"\127\104\317\371\377\353\120\002\224\156\211\273\150\155\174\144"
	"\161\006\373\271\356\215\246\226\322\254\071\236\067\057\037\336"
	"\257\141\113\211\273\302\214\047\103\246\365\320\151\224\363\221"
	"\154\030\234\342\263\216\360\175\130\046\033\217\125\072\156\005"
	"\233\271\216\126\174\033\175\277\301\163\217\052\007\202\274\164"
#define      msg2_z	19
#define      msg2	((&data[383]))
	"\117\243\371\230\343\105\170\120\342\060\311\166\026\256\225\225"
	"\143\216\346\272\347"
#define      inlo_z	3
#define      inlo	((&data[403]))
	"\366\045\305"
#define      lsto_z	1
#define      lsto	((&data[406]))
	"\116"
#define      opts_z	1
#define      opts	((&data[407]))
	"\334"
#define      text_z	869
#define      text	((&data[570]))
	"\127\025\164\162\223\063\064\006\303\136\016\105\033\203\341\163"
	"\332\061\133\042\375\232\221\345\152\125\010\250\037\306\237\166"
	"\334\023\351\157\107\035\165\012\174\204\120\227\010\062\013\342"
	"\143\146\005\141\001\226\107\153\354\117\023\013\026\263\201\362"
	"\307\153\141\017\211\327\031\005\134\152\234\144\234\250\106\000"
	"\016\113\141\020\342\250\174\316\370\217\331\016\103\133\000\013"
	"\307\142\032\120\072\064\125\226\236\362\372\073\233\101\073\251"
	"\215\235\272\157\105\066\076\076\306\027\114\012\163\115\025\073"
	"\257\057\213\351\144\341\200\003\324\172\076\157\273\172\031\110"
	"\030\323\270\136\011\366\234\320\016\350\332\202\066\357\275\346"
	"\037\110\104\020\313\014\120\012\101\061\325\022\107\206\166\176"
	"\326\040\006\334\226\352\203\117\250\210\373\122\172\102\106\252"
	"\150\215\164\367\315\124\177\332\202\002\271\170\205\064\110\067"
	"\023\364\300\154\110\225\226\242\371\375\107\172\173\201\220\100"
	"\071\016\003\141\166\377\230\147\067\063\247\003\255\003\335\111"
	"\114\201\141\366\355\071\334\042\361\043\346\254\051\360\176\270"
	"\014\216\162\050\215\341\337\050\323\104\371\165\077\321\141\106"
	"\142\060\030\363\000\207\014\300\246\071\362\005\167\061\164\241"
	"\013\137\031\320\015\177\151\353\355\075\330\111\137\236\350\201"
	"\134\354\312\045\323\041\342\210\327\273\361\013\340\374\375\201"
	"\251\130\232\102\064\154\141\225\247\346\336\357\113\054\343\173"
	"\324\065\332\261\032\176\256\250\315\031\022\016\317\375\104\123"
	"\223\042\035\301\224\106\157\050\122\372\250\304\234\115\060\163"
	"\136\330\141\377\333\051\147\241\141\213\355\054\021\272\056\314"
	"\364\152\255\230\355\314\062\032\325\312\045\043\002\002\306\345"
	"\001\005\210\140\251\121\257\016\072\266\153\044\104\047\067\113"
	"\170\040\041\356\264\117\006\054\205\014\143\013\076\147\156\157"
	"\153\321\074\366\160\024\300\103\223\044\220\315\114\127\270\022"
	"\116\323\344\020\200\110\237\316\100\173\002\354\051\302\230\240"
	"\117\051\241\364\237\310\070\225\162\340\355\331\035\017\034\023"
	"\140\200\202\042\035\310\136\171\120\077\251\032\061\147\347\101"
	"\246\266\070\035\275\357\221\364\027\146\033\073\362\021\003\275"
	"\127\364\304\055\157\056\126\372\323\053\374\270\142\173\005\042"
	"\161\305\157\336\277\071\127\111\372\265\014\072\303\253\310\005"
	"\222\010\157\251\231\260\066\265\353\017\327\072\335\026\017\265"
	"\303\042\322\331\344\064\353\100\253\001\222\227\127\377\275\064"
	"\350\326\161\113\101\135\010\236\044\251\117\261\104\037\366\240"
	"\224\135\046\113\217\363\347\153\105\335\276\003\133\174\103\347"
	"\121\310\256\277\200\123\116\062\047\261\272\157\132\006\124\342"
	"\177\226\111\001\240\155\152\130\054\150\051\370\346\234\011\331"
	"\135\377\214\106\314\127\101\022\011\153\321\265\252\065\117\366"
	"\260\211\305\011\123\335\340\102\261\126\153\126\361\020\176\254"
	"\211\206\260\014\336\326\040\264\327\167\270\044\155\032\107\355"
	"\347\053\133\346\124\053\015\220\231\113\243\237\311\252\124\164"
	"\002\061\331\272\065\050\063\246\345\163\077\144\246\056\216\252"
	"\351\116\101\213\172\022\160\177\070\354\074\314\361\305\116\220"
	"\323\015\332\237\253\277\236\305\052\244\055\005\266\361\232\212"
	"\220\124\132\153\377\173\064\044\173\050\036\234\000\177\274\162"
	"\363\203\053\210\257\063\222\371\215\171\231\012\275\225\022\166"
	"\340\020\215\341\034\336\230\116\202\275\050\377\027\267\273\301"
	"\331\073\277\374\226\303\257\270\031\077\267\041\011\335\040\363"
	"\123\163\166\027\104\362\302\020\312\321\371\132\357\015\370\337"
	"\213\132\304\310\357\356\116\267\065\373\020\154\107\205\162\302"
	"\073\111\224\300\075\367\301\271\056\317\075\062\236\257\010\305"
	"\305\205\220\057\364\123\165\143\124\145\044\274\015\131\262\362"
	"\217\135\300\270\252\003\004\126\176\212\125\026\027\307\340\177"
	"\311\157\037\025\331\234\204\166\057\155\310\110\334\176\330\044"
	"\121\061\232\210\312\055\112\135\037\136\144\025\212\235\337\122"
	"\050\164\307\043\145\152\031\104\106\377\302\304\260\244\113\316"
	"\054\274\365\045\330\013\210\302\016\113\033\227\115\156\340\355"
	"\236\311\007\255\031\372\373\162\313\272\143\001\236\372\306\103"
	"\051\145\376\152\324\254\275\063\356\200\035\310\177\042\336\141"
	"\133\365\257\325\322\172\316\237\150\303\023\032\234\321\176\126"
	"\306\134\024\257\377\227\352\332\220\372\104\133\142\174\112\004"
	"\303\313\224\076\106\204\241\317\203\052\120\206\376\312\305\155"
	"\206\100\206\316\130\131\207\266\143\175\122\064\213\073\016\016"
	"\161\376\313\127\036\023\047\242\076\167\051\074\102\356\251\310"
	"\057\060\227\207\211\036\076\355\234\221\042\047\314\061\065\076"
	"\057\001\226\116\025\276\360\123\066\032\217\170\011\070\101\070"
	"\150\330\300\362\367\376\340\223\220\002\273\135\064\361\233\144"
	"\362\062\262\007\361\243\132\047\275\351\240\306\042\341\377\213"
	"\272\277\176\261\276\136\104\116\141\377\253\225\360\107\371\342"
	"\172\254\352\153\117\104\222\015\056\062\323\121\024\323\334\316"
	"\222\132\177\121\271\303\237\033\303\113\260\264\223\252\227\015"
	"\126\201\170\246\306\013\263\365\076\207\106\122\132\042\040\355"
	"\175\240\076\066\144\335\121\047\051\002\334\274\254\163\312\003"
	"\365\103\251\273\116\134\260\215\344\366\340\076\031\001\053\226"
	"\241\151\315\005\107\037\055\161\041"
#define      msg1_z	42
#define      msg1	((&data[1650]))
	"\175\075\355\174\157\161\263\155\064\157\320\305\027\043\306\142"
	"\015\075\241\250\026\144\105\104\133\202\142\025\167\336\103\074"
	"\356\176\124\273\346\230\220\353\157\371\033\370\321\162\073\172"
	"\056\212\327"
#define      tst2_z	19
#define      tst2	((&data[1700]))
	"\022\055\146\036\054\010\065\150\122\023\304\334\131\365\215\227"
	"\363\105\345\325\370\372"
#define      chk2_z	19
#define      chk2	((&data[1726]))
	"\205\232\217\123\331\267\373\324\303\202\323\213\206\034\311\233"
	"\376\313\076\135\253\206\041"
#define      rlax_z	1
#define      rlax	((&data[1745]))
	"\045"
#define      date_z	1
#define      date	((&data[1746]))
	"\351"
#define      shll_z	10
#define      shll	((&data[1748]))
	"\125\125\111\014\150\304\206\315\263\124\110\157"
#define      xecc_z	15
#define      xecc	((&data[1762]))
	"\255\366\065\012\145\052\032\105\352\120\346\111\160\136\330\261"
	"\120\006\205\325"
#define      chk1_z	22
#define      chk1	((&data[1780]))
	"\105\003\361\045\111\311\241\300\032\154\205\157\131\366\372\012"
	"\054\156\041\353\232\152\030\073\232\077\141"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
